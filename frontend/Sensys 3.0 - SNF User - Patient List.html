<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sensys - Patient List</title>
  <style>
    :root{
      --navy:#0D3B66;
      --mint:#A8E6CF;
      --mint-strong:#86d9ba;
      --bg:#ffffff;
      --bg-2:#F5F7FA;
      --text:#0f172a;
      --muted:#5b6b84;
      --line: rgba(13,59,102,.14);
      --shadow:0 18px 36px rgba(13,59,102,.08);
      --r-lg:20px;
      --r-md:12px;
      --sidebar-w:78px;
      --logo-offset-x:-68px;
      --logo-offset-y:-58px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    html,body{
      margin:0;
      background:
        radial-gradient(900px 320px at 50% 1%, rgba(15,23,42,.035), rgba(255,255,255,0) 80%),
        linear-gradient(180deg, #ffffff 0%, #f5f7fa 100%);
      background-repeat:no-repeat;
      background-attachment:fixed;
      color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    .layout{
      min-height:100vh;
      display:flex;
    }
    .sidebar{
      width:var(--sidebar-w);
      background:#fff;
      border-right:1px solid rgba(13,59,102,.08);
      display:flex;
      flex-direction:column;
      align-items:center;
      padding:0 0 14px;
      position:relative;
    }
    .sidebar-logo{
      width:100%;
      height:92px;
      overflow:hidden;
      margin-bottom:18px;
      position:relative;
    }
    .sidebar-logo img{
      width:150px;
      height:150px;
      position:absolute;
      left:-6px;
      top:-6px;
      transform: translate(var(--logo-offset-x), var(--logo-offset-y));
      display:block;
    }
    .side-nav{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:14px;
      margin-top:6px;
    }
    .side-btn{
      width:42px;
      height:42px;
      border-radius:14px;
      border:0;
      background:#fff;
      display:flex;
      align-items:center;
      justify-content:center;
      color:var(--navy);
      cursor:pointer;
      transition:border-color .15s ease, box-shadow .15s ease, transform .15s ease;
    }
    .side-btn:hover{
      box-shadow:0 0 0 2px rgba(168,230,207,.35);
      transform: translateY(-1px);
    }
    .side-btn svg{
      width:35px;
      height:35px;
    }
    .side-btn .cls-1{
      stroke:currentColor;
      fill:none;
      stroke-linecap:round;
      stroke-linejoin:round;
      stroke-width:3.2px;
    }
    .side-spacer{flex:1}
    .profile-wrap{
      position:relative;
      margin-bottom:6px;
    }
    .profile-menu{
      position:absolute;
      left:52px;
      bottom:0;
      background:#fff;
      border:1px solid rgba(13,59,102,.12);
      border-radius:12px;
      box-shadow:0 18px 36px rgba(13,59,102,.16);
      padding:8px;
      min-width:170px;
      display:none;
      z-index:10;
    }
    .profile-menu button{
      width:100%;
      border:0;
      background:#fff;
      text-align:left;
      padding:8px 10px;
      border-radius:10px;
      font-size:12px;
      font-weight:800;
      color:#111827;
      cursor:pointer;
    }
    .profile-menu button:hover{
      background:rgba(168,230,207,.18);
    }
    .page{
      min-height:100vh;
      padding:24px 22px 24px;
      max-width:1100px;
      margin:0 auto;
      display:flex;
      flex-direction:column;
      flex:1;
    }
    .topbar{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:16px;
      margin-bottom:10px;
    }
    .brand{
      display:flex;
      align-items:flex-start;
      gap:16px;
    }
    .brand .icon{
      margin-top:6px;
      width:84px;
      height:84px;
      color:var(--mint-strong);
      display:inline-flex;
      align-items:center;
      justify-content:center;
    }
    .brand .icon svg{width:100%;height:100%}
    .brand .icon .cls-1{
      stroke:currentColor;
      fill:none;
      stroke-linecap:round;
      stroke-linejoin:round;
      stroke-width:2.1px;
    }
    .title h1{
      margin:0 0 6px;
      font-size:40px;
      font-weight:400;
      color:var(--navy);
      letter-spacing:.2px;
    }
    .title p{
      margin:0;
      font-size:14px;
      color:var(--muted);
    }
    .logo{
      height:96px;
      width:auto;
      display:block;
      opacity:0.0;
    }
    .toolbar{
      margin-top:18px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }
    .toolbar-wrap{
      position:sticky;
      top:0;
      z-index:5;
      background:linear-gradient(180deg, #ffffff 0%, #f5f7fa 100%);
      background-attachment:fixed;
      border-top:1px solid rgba(13,59,102,.08);
      padding-bottom:10px;
    }
    .tabs{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .chip{
      padding:10px 16px;
      border-radius:999px;
      border:1px solid rgba(13,59,102,.14);
      background:#fff;
      font-size:13px;
      font-weight:800;
      color:#42526b;
      cursor:pointer;
      user-select:none;
      transition:border-color .15s ease, box-shadow .15s ease, transform .15s ease;
    }
    .chip:hover{
      border-color:rgba(168,230,207,.85);
      box-shadow:0 10px 18px rgba(13,59,102,.08);
      transform: translateY(-1px);
    }
    .chip.on{
      background:rgba(168,230,207,.45);
      border-color:rgba(168,230,207,.95);
      color:var(--navy);
    }
    .search-wrap{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
    }
    .search{
      width:min(360px, 92vw);
      padding:12px 14px;
      border-radius:12px;
      border:1px solid rgba(13,59,102,.18);
      background:#fff;
      font-size:14px;
      outline:none;
      box-shadow:0 8px 16px rgba(13,59,102,.06);
      transition:border-color .15s ease, box-shadow .15s ease, transform .15s ease;
    }
    .search:focus{
      border-color: rgba(168,230,207,.95);
      box-shadow: 0 10px 22px rgba(13,59,102,.12);
      transform: translateY(-1px);
    }
    .btn{
      border:1px solid var(--line);
      background:#fff;
      padding:10px 14px;
      border-radius:12px;
      font-size:13px;
      font-weight:800;
      color:var(--navy);
      cursor:pointer;
      transition:border-color .15s ease, box-shadow .15s ease, transform .15s ease;
    }
    .btn:hover{
      border-color: rgba(168,230,207,.9);
      box-shadow:0 10px 18px rgba(13,59,102,.10);
      transform: translateY(-1px);
    }
    .list{
      margin-top:16px;
      display:flex;
      flex-direction:column;
      gap:14px;
      overflow:auto;
      padding-bottom:12px;
      max-height:calc(100vh - 245px);
      background:linear-gradient(180deg, #ffffff 0%, #f5f7fa 100%);
      background-attachment:local;
    }
    .row{
      background:#fff;
      border:1px solid rgba(13,59,102,.10);
      border-radius:16px;
      box-shadow:0 10px 24px rgba(13,59,102,.06);
      padding:16px 18px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
    }
    .row-main{
      display:flex;
      flex-direction:column;
      gap:8px;
      min-width:0;
    }
    .name{
      font-size:18px;
      font-weight:800;
      color:var(--navy);
    }
    .meta{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      color:var(--muted);
      font-size:13px;
    }
    .pill{
      padding:6px 10px;
      border-radius:999px;
      background:rgba(168,230,207,.35);
      color:var(--navy);
      font-weight:800;
      font-size:12px;
    }
    .meta b{color:#0f172a}
    .actions{
      display:flex;
      gap:8px;
      align-items:center;
      opacity:.6;
    }
    .icon-btn{
      width:34px;
      height:34px;
      border-radius:10px;
      border:1px dashed rgba(13,59,102,.3);
      background:transparent;
      cursor:default;
    }
    .empty{
      text-align:center;
      color:var(--muted);
      font-size:13px;
      margin-top:30px;
    }
    .modal-backdrop{
      position:fixed;
      inset:0;
      background:rgba(15,23,42,.45);
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
      z-index:9999;
    }
    .modal{
      width:min(520px, 94vw);
      background:#fff;
      border:1px solid rgba(13,59,102,.12);
      border-radius:18px;
      box-shadow:0 26px 60px rgba(13,59,102,.22);
      padding:18px;
    }
    .modal h3{
      margin:0 0 8px;
      font-size:16px;
      font-weight:900;
      color:#0f172a;
    }
    .field{
      margin-top:12px;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .label{
      font-size:12px;
      font-weight:800;
      color:#334155;
      letter-spacing:.2px;
    }
    .input, .select{
      width:100%;
      padding:10px 12px;
      border:1px solid rgba(13,59,102,.18);
      border-radius:12px;
      font-size:13px;
      outline:none;
      background:#fff;
    }
    .modal-actions{
      margin-top:16px;
      display:flex;
      justify-content:flex-end;
      gap:10px;
    }
    @media (max-width: 900px){
      .row{flex-direction:column;align-items:flex-start}
      .actions{align-self:flex-end}
      .title h1{font-size:34px}
    }
  </style>
</head>
<body>
  <div class="layout">
    <aside class="sidebar">
      <div class="sidebar-logo">
        <img src="/static/images/Evolv-Health-E-Color.svg" alt="Evolv Health" onerror="this.onerror=null;this.src='Logos/Evolv-Health-E-Color.svg';" />
      </div>
      <div class="side-nav">
        <button class="side-btn" id="navHome" title="Home" aria-label="Home">
          <svg viewBox="0 0 84.28 75.71" aria-hidden="true">
            <g>
              <polygon class="cls-1" points="72.76 74.32 72.76 41.92 82.89 41.92 82.89 35.62 71 25.54 71 7.55 58.75 7.55 58.75 15.16 42.14 1.79 1.39 35.62 1.39 41.92 11.52 41.92 11.52 74.31 32.09 74.32 32.09 52.8 52.18 52.8 52.18 74.32 72.76 74.32" />
              <polyline class="cls-1" points="11.52 41.92 42.14 16.92 72.76 41.92" />
            </g>
          </svg>
        </button>
        <button class="side-btn" id="navInpatient" title="Inpatient List" aria-label="Inpatient List">
          <svg viewBox="0 0 77.02 76.67" aria-hidden="true">
            <g>
              <g>
                <path class="cls-1" d="M75.63,58.69v14.53c0,1.14-.92,2.06-2.06,2.06H3.45c-1.14,0-2.06-.92-2.06-2.06v-14.55c0-1.14.92-2.06,2.06-2.06l70.12.02c1.14,0,2.06.92,2.06,2.06Z" />
                <line class="cls-1" x1="65.85" y1="66.01" x2="58.74" y2="66.01" />
              </g>
              <g>
                <path class="cls-1" d="M75.63,31.08v14.53c0,1.14-.92,2.06-2.06,2.06H3.45c-1.14,0-2.06-.92-2.06-2.06v-14.55c0-1.14.92-2.06,2.06-2.06l70.12.02c1.14,0,2.06.92,2.06,2.06Z" />
                <line class="cls-1" x1="65.85" y1="38.4" x2="58.74" y2="38.4" />
              </g>
              <g>
                <path class="cls-1" d="M75.63,3.46v14.53c0,1.14-.92,2.06-2.06,2.06H3.45c-1.14,0-2.06-.92-2.06-2.06V3.45c0-1.14.92-2.06,2.06-2.06l70.12.02c1.14,0,2.06.92,2.06,2.06Z" />
                <line class="cls-1" x1="65.85" y1="10.78" x2="58.74" y2="10.78" />
              </g>
            </g>
          </svg>
        </button>
        <button class="side-btn" id="navDischarged" title="Discharged Patients" aria-label="Discharged Patients">
          <svg viewBox="0 0 63.35 80.07" aria-hidden="true">
            <g>
              <g>
                <path class="cls-1" d="M14.34,33.31l-3.49,3.35v20.24l-5.37,8.59c-1.29,2.06-.6,4.78,1.52,5.97l.05.03c1.96,1.11,4.44.5,5.67-1.38l6.59-10.08.07-10.59,8.37,5.92,2.54,6.78c.53,1.41,2.19,2.56,3.69,2.56h.44c2.9,0,4.88-2.91,3.83-5.61l-3.91-9.97-9.06-6.49.03-16.43" />
                <path class="cls-1" d="M25.68,10.8c.39,3.99-2.52,7.54-6.51,7.93-3.99.39-7.54-2.52-7.93-6.51-.39-3.99,2.52-7.54,6.51-7.93,3.99-.39,7.54,2.52,7.93,6.51Z" />
                <path class="cls-1" d="M25.6,35.54l4.38,2.32c2,1.06,4.48.27,5.5-1.75h0c.99-1.96.23-4.35-1.71-5.39l-12.71-6.8h-8.41s-9.81,8.84-9.81,8.84v9.8c0,2.68,2.17,4.86,4.86,4.86h3.14" />
              </g>
              <polyline class="cls-1" points="0 78.69 21.94 78.69 21.94 71.37 44.55 71.37 44.55 62.95 61.96 62.95 61.96 1.39 41.17 1.39 46.02 9.76 41.17 18.33 61.96 18.33" />
            </g>
          </svg>
        </button>
        <button class="side-btn" id="navCalendar" title="Discharge Calendar" aria-label="Discharge Calendar">
          <svg viewBox="0 0 74.16 76.04" aria-hidden="true">
            <g>
              <g>
                <g>
                  <line class="cls-1" x1="26.55" y1="10.08" x2="52.53" y2="10.08" />
                  <path class="cls-1" d="M66.54,10.08h2.08c2.3,0,4.16,1.86,4.16,4.16v56.27c0,2.3-1.86,4.16-4.16,4.16H5.54c-2.3,0-4.16-1.86-4.16-4.16V14.23c0-2.3,1.86-4.16,4.16-4.16h7.14" />
                  <line class="cls-1" x1="1.39" y1="26.73" x2="72.78" y2="26.73" />
                </g>
                <line class="cls-1" x1="32.51" y1="50.58" x2="41.55" y2="50.58" />
                <line class="cls-1" x1="32.51" y1="63.68" x2="41.55" y2="63.68" />
                <line class="cls-1" x1="12.09" y1="63.68" x2="21.13" y2="63.68" />
                <line class="cls-1" x1="52.93" y1="37.47" x2="61.97" y2="37.47" />
                <line class="cls-1" x1="32.51" y1="37.47" x2="41.55" y2="37.47" />
                <line class="cls-1" x1="12.09" y1="37.47" x2="21.13" y2="37.47" />
                <line class="cls-1" x1="52.93" y1="50.58" x2="61.97" y2="50.58" />
                <line class="cls-1" x1="12.09" y1="50.58" x2="21.13" y2="50.58" />
              </g>
              <rect class="cls-1" x="13.22" y="1.39" width="7.89" height="17.38" rx="3.94" ry="3.94" />
              <path class="cls-1" d="M57,18.77h0c-2.18,0-3.94-1.77-3.94-3.94V5.33c0-2.18,1.77-3.94,3.94-3.94h0c2.18,0,3.94,1.77,3.94,3.94v9.5c0,2.18-1.77,3.94-3.94,3.94Z" />
            </g>
          </svg>
        </button>
      </div>
      <div class="side-spacer"></div>
      <div class="profile-wrap">
        <button class="side-btn" id="profileBtn" title="Account" aria-label="Account">
          <svg viewBox="0 0 65.83 73.85" aria-hidden="true">
            <g>
              <g>
                <path class="cls-1" d="M64.44,73.85v-21.35c-.11-.1-10.45-8.89-31.53-8.89S1.47,52.43,1.39,52.5h0v21.35" />
                <path class="cls-1" d="M46.83,16.09c0,9.32-6.14,16.65-13.71,16.65s-13.71-7.32-13.71-16.65S25.55,1.39,33.12,1.39s13.71,5.38,13.71,14.7Z" />
              </g>
              <line class="cls-1" x1="17.42" y1="73.85" x2="17.42" y2="60.4" />
              <line class="cls-1" x1="48.82" y1="73.85" x2="48.82" y2="60.4" />
            </g>
          </svg>
        </button>
        <div class="profile-menu" id="profileMenu">
          <button id="changePasswordBtn">Change Password</button>
          <button id="signOutBtn">Sign Out</button>
        </div>
      </div>
    </aside>

    <div class="page">
    <div class="topbar">
      <div class="brand">
        <span class="icon" aria-hidden="true">
          <svg viewBox="0 0 85.16 71.36">
            <g>
              <polyline class="cls-1" points="27.53 58.07 26.36 64.74 22.04 68.98 22.04 69.97 46.09 69.97 46.09 68.98 41.77 64.74 40.6 58.07" />
              <g>
                <g>
                  <rect class="cls-1" x="54.66" y="21.81" width="29.11" height="48.08" rx="3.87" ry="3.87" />
                  <line class="cls-1" x1="54.66" y1="30.61" x2="83.77" y2="30.61" />
                  <line class="cls-1" x1="54.66" y1="58.39" x2="83.77" y2="58.39" />
                </g>
                <g>
                  <path class="cls-1" d="M48.2,58.39H5.71c-2.39,0-4.33-1.94-4.33-4.33V5.71C1.39,3.32,3.32,1.39,5.71,1.39h56.7c2.39,0,4.33,1.94,4.33,4.33v9.65" />
                  <line class="cls-1" x1="1.39" y1="47.55" x2="48.2" y2="47.55" />
                </g>
              </g>
            </g>
          </svg>
        </span>
        <div class="title">
          <h1>Inpatient List</h1>
          <p>All patients currently admitted at your facility.</p>
        </div>
      </div>
      <img class="logo" src="/static/images/Sensys-S-blue2.svg" alt="Sensys" onerror="this.onerror=null;this.src='Logos/Sensys S blue2.svg';" />
    </div>

    <div class="toolbar-wrap">
      <div class="toolbar">
        <div class="tabs">
          <div id="tabAll" class="chip on">All (0)</div>
          <div id="tabDischarging" class="chip">Discharging (0)</div>
        </div>
        <div class="search-wrap">
          <input id="search" class="search" placeholder="Search patient name..." />
          <button id="openFilters" class="btn">Filters</button>
        </div>
      </div>
    </div>

    <div id="list" class="list"></div>
    <div id="empty" class="empty" style="display:none;">No patients match your filters.</div>
    </div>
  </div>

  <div id="filterBackdrop" class="modal-backdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true">
      <h3>Filter Patients</h3>

      <div class="field">
        <div class="label">Admit date range</div>
        <div style="display:flex;gap:10px;flex-wrap:wrap;">
          <input id="admitFrom" class="input" type="date" />
          <input id="admitTo" class="input" type="date" />
        </div>
      </div>

      <div class="field">
        <div class="label">Insurance name</div>
        <input id="insuranceFilter" class="input" placeholder="Start typing..." />
      </div>

      <div class="field">
        <div class="label">Sort by</div>
        <select id="sortBy" class="select">
          <option value="last">Last name</option>
          <option value="admit">Admit date</option>
        </select>
      </div>

      <div class="modal-actions">
        <button id="clearFilters" class="btn">Clear</button>
        <button id="applyFilters" class="btn" style="background:var(--navy);color:#fff;border-color:transparent;">Apply</button>
      </div>
    </div>
  </div>

<script>
(function(){
  const listEl = document.getElementById("list");
  const emptyEl = document.getElementById("empty");
  const tabAll = document.getElementById("tabAll");
  const tabDischarging = document.getElementById("tabDischarging");
  const search = document.getElementById("search");
  const profileBtn = document.getElementById("profileBtn");
  const profileMenu = document.getElementById("profileMenu");
  const signOutBtn = document.getElementById("signOutBtn");
  const changePasswordBtn = document.getElementById("changePasswordBtn");
  const navHome = document.getElementById("navHome");
  const navInpatient = document.getElementById("navInpatient");
  const navDischarged = document.getElementById("navDischarged");
  const navCalendar = document.getElementById("navCalendar");

  const filterBackdrop = document.getElementById("filterBackdrop");
  const admitFrom = document.getElementById("admitFrom");
  const admitTo = document.getElementById("admitTo");
  const insuranceFilter = document.getElementById("insuranceFilter");
  const sortBy = document.getElementById("sortBy");

  let ALL_ROWS = [];
  let ACTIVE_TAB = "all";
  const SAMPLE_ROWS = [
    { id: 1, patient_name: "Adams, Taylor", patient_dob: "1943-06-12", room: "101A", insurance_name1: "Aetna", insurance_number1: "AE-443201", admit_date: "2026-01-08", dc_date: "2026-01-28" },
    { id: 2, patient_name: "Barnes, Jordan", patient_dob: "1938-11-04", room: "102B", insurance_name1: "UnitedHealthcare", insurance_number1: "UH-992144", admit_date: "2026-01-06", dc_date: "" },
    { id: 3, patient_name: "Carter, Riley", patient_dob: "1949-03-19", room: "103C", insurance_name1: "Humana", insurance_number1: "HU-771209", admit_date: "2026-01-10", dc_date: "2026-02-02" },
    { id: 4, patient_name: "Diaz, Morgan", patient_dob: "1951-09-22", room: "104A", insurance_name1: "Blue Cross", insurance_number1: "BC-110344", admit_date: "2026-01-02", dc_date: "" },
    { id: 5, patient_name: "Evans, Casey", patient_dob: "1940-01-30", room: "105B", insurance_name1: "Cigna", insurance_number1: "CI-556214", admit_date: "2026-01-04", dc_date: "2026-01-26" },
    { id: 6, patient_name: "Foster, Avery", patient_dob: "1936-07-15", room: "106A", insurance_name1: "Kaiser", insurance_number1: "KA-889100", admit_date: "2026-01-11", dc_date: "" },
    { id: 7, patient_name: "Garcia, Quinn", patient_dob: "1955-02-10", room: "107C", insurance_name1: "Medicare", insurance_number1: "MC-230119", admit_date: "2026-01-09", dc_date: "2026-02-05" },
    { id: 8, patient_name: "Harris, Logan", patient_dob: "1942-12-01", room: "108A", insurance_name1: "Aetna", insurance_number1: "AE-993214", admit_date: "2026-01-12", dc_date: "" },
    { id: 9, patient_name: "Iverson, Blake", patient_dob: "1939-05-28", room: "109B", insurance_name1: "UnitedHealthcare", insurance_number1: "UH-221045", admit_date: "2026-01-07", dc_date: "2026-01-30" },
    { id: 10, patient_name: "Jackson, Drew", patient_dob: "1946-08-09", room: "110C", insurance_name1: "Humana", insurance_number1: "HU-118220", admit_date: "2026-01-05", dc_date: "" },
    { id: 11, patient_name: "Keller, Reese", patient_dob: "1950-04-17", room: "111A", insurance_name1: "Blue Cross", insurance_number1: "BC-441290", admit_date: "2026-01-03", dc_date: "2026-02-01" },
    { id: 12, patient_name: "Lopez, Sky", patient_dob: "1937-10-03", room: "112B", insurance_name1: "Cigna", insurance_number1: "CI-664002", admit_date: "2026-01-13", dc_date: "" },
    { id: 13, patient_name: "Mason, Parker", patient_dob: "1948-02-27", room: "113C", insurance_name1: "Kaiser", insurance_number1: "KA-701155", admit_date: "2026-01-01", dc_date: "2026-01-29" },
    { id: 14, patient_name: "Nguyen, Alex", patient_dob: "1941-06-08", room: "114A", insurance_name1: "Medicare", insurance_number1: "MC-449981", admit_date: "2026-01-14", dc_date: "" },
    { id: 15, patient_name: "Ortiz, Jamie", patient_dob: "1952-09-14", room: "115B", insurance_name1: "Aetna", insurance_number1: "AE-554099", admit_date: "2026-01-15", dc_date: "2026-02-03" },
    { id: 16, patient_name: "Patel, Rowan", patient_dob: "1935-12-20", room: "116C", insurance_name1: "UnitedHealthcare", insurance_number1: "UH-778801", admit_date: "2026-01-16", dc_date: "" },
    { id: 17, patient_name: "Quinn, Casey", patient_dob: "1944-07-02", room: "117A", insurance_name1: "Humana", insurance_number1: "HU-119002", admit_date: "2026-01-17", dc_date: "2026-01-31" },
    { id: 18, patient_name: "Reed, Morgan", patient_dob: "1947-03-11", room: "118B", insurance_name1: "Blue Cross", insurance_number1: "BC-338900", admit_date: "2026-01-18", dc_date: "" },
    { id: 19, patient_name: "Shaw, Riley", patient_dob: "1938-01-26", room: "119C", insurance_name1: "Cigna", insurance_number1: "CI-882116", admit_date: "2026-01-19", dc_date: "2026-02-06" },
    { id: 20, patient_name: "Turner, Avery", patient_dob: "1956-05-05", room: "120A", insurance_name1: "Kaiser", insurance_number1: "KA-554320", admit_date: "2026-01-20", dc_date: "" },
    { id: 21, patient_name: "Usher, Quinn", patient_dob: "1940-11-18", room: "121B", insurance_name1: "Medicare", insurance_number1: "MC-901122", admit_date: "2026-01-21", dc_date: "2026-02-07" },
    { id: 22, patient_name: "Vasquez, Drew", patient_dob: "1943-02-23", room: "122C", insurance_name1: "Aetna", insurance_number1: "AE-220145", admit_date: "2026-01-22", dc_date: "" },
    { id: 23, patient_name: "Wright, Jordan", patient_dob: "1939-08-30", room: "123A", insurance_name1: "UnitedHealthcare", insurance_number1: "UH-450021", admit_date: "2026-01-23", dc_date: "2026-02-08" },
    { id: 24, patient_name: "Xiong, Taylor", patient_dob: "1945-09-09", room: "124B", insurance_name1: "Humana", insurance_number1: "HU-990311", admit_date: "2026-01-24", dc_date: "" },
    { id: 25, patient_name: "Young, Parker", patient_dob: "1936-04-25", room: "125C", insurance_name1: "Blue Cross", insurance_number1: "BC-002911", admit_date: "2026-01-25", dc_date: "2026-02-09" },
    { id: 26, patient_name: "Zimmer, Casey", patient_dob: "1949-06-13", room: "126A", insurance_name1: "Cigna", insurance_number1: "CI-774230", admit_date: "2026-01-26", dc_date: "" },
    { id: 27, patient_name: "Allen, Reese", patient_dob: "1951-01-02", room: "127B", insurance_name1: "Kaiser", insurance_number1: "KA-113390", admit_date: "2026-01-27", dc_date: "2026-02-10" },
    { id: 28, patient_name: "Bishop, Jamie", patient_dob: "1942-03-07", room: "128C", insurance_name1: "Medicare", insurance_number1: "MC-331002", admit_date: "2026-01-28", dc_date: "" },
    { id: 29, patient_name: "Coleman, Sky", patient_dob: "1946-10-16", room: "129A", insurance_name1: "Aetna", insurance_number1: "AE-998201", admit_date: "2026-01-29", dc_date: "2026-02-11" },
    { id: 30, patient_name: "Duncan, Rowan", patient_dob: "1953-12-05", room: "130B", insurance_name1: "UnitedHealthcare", insurance_number1: "UH-550409", admit_date: "2026-01-30", dc_date: "" }
  ];

  function token(){
    return (localStorage.getItem("sensys_token") || "").trim();
  }
  function authHeaders(){
    return { "Authorization": "Bearer " + token() };
  }
  function esc(s){
    return String(s ?? "").replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
  }
  function parseDate(s){
    if(!s) return null;
    const d = new Date(s + "T00:00:00");
    return isNaN(d.getTime()) ? null : d;
  }
  function isFutureDate(s){
    const d = parseDate(s);
    if(!d) return false;
    const today = new Date();
    today.setHours(0,0,0,0);
    return d.getTime() > today.getTime();
  }
  function withinRange(d, start, end){
    if(!d) return false;
    if(start && d.getTime() < start.getTime()) return false;
    if(end && d.getTime() > end.getTime()) return false;
    return true;
  }

  function renderCounts(){
    const dischargingCount = ALL_ROWS.filter(r => isFutureDate(r.dc_date)).length;
    tabAll.textContent = `All (${ALL_ROWS.length})`;
    tabDischarging.textContent = `Discharging (${dischargingCount})`;
  }

  function applyFilters(){
    const q = (search.value || "").trim().toLowerCase();
    const ins = (insuranceFilter.value || "").trim().toLowerCase();
    const from = parseDate(admitFrom.value || "");
    const to = parseDate(admitTo.value || "");

    let rows = ALL_ROWS.slice();

    if(ACTIVE_TAB === "discharging"){
      rows = rows.filter(r => isFutureDate(r.dc_date));
    }

    if(q){
      rows = rows.filter(r => (r.patient_name || "").toLowerCase().includes(q));
    }

    if(ins){
      rows = rows.filter(r => (r.insurance_name1 || "").toLowerCase().includes(ins));
    }

    if(from || to){
      rows = rows.filter(r => {
        const d = parseDate(r.admit_date);
        return withinRange(d, from, to);
      });
    }

    if(sortBy.value === "admit"){
      rows.sort((a,b) => {
        const da = parseDate(a.admit_date);
        const db = parseDate(b.admit_date);
        const ta = da ? da.getTime() : 0;
        const tb = db ? db.getTime() : 0;
        return tb - ta;
      });
    }else{
      rows.sort((a,b) => (a.patient_name || "").localeCompare(b.patient_name || "", undefined, { sensitivity:"base" }));
    }

    renderList(rows);
  }

  function renderList(rows){
    if(!rows.length){
      listEl.innerHTML = "";
      emptyEl.style.display = "block";
      return;
    }
    emptyEl.style.display = "none";
    listEl.innerHTML = rows.map(r => {
      const rid = r.id ? String(r.id) : "";
      const name = r.patient_name || "Patient";
      const dob = r.patient_dob || "—";
      const room = r.room || "—";
      const insName = r.insurance_name1 || "—";
      const insNum = r.insurance_number1 || "—";
      const admit = r.admit_date || "—";
      const dc = r.dc_date || "—";
      return `
        <div class="row" data-id="${esc(rid)}" role="button" tabindex="0">
          <div class="row-main">
            <div class="name">${esc(name)}</div>
            <div class="meta">
              <span class="pill">DOB: ${esc(dob)}</span>
              <span class="pill">Room: ${esc(room)}</span>
              <span class="pill">Insurance: ${esc(insName)}</span>
              <span class="pill"># ${esc(insNum)}</span>
            </div>
            <div class="meta">
              <span><b>Admit:</b> ${esc(admit)}</span>
              <span><b>DC:</b> ${esc(dc)}</span>
            </div>
          </div>
          <div class="actions" aria-label="future actions">
            <div class="icon-btn" title="Coming soon"></div>
            <div class="icon-btn" title="Coming soon"></div>
            <div class="icon-btn" title="Coming soon"></div>
          </div>
        </div>
      `;
    }).join("");

    listEl.querySelectorAll(".row[data-id]").forEach(row => {
      const rid = row.getAttribute("data-id");
      if(!rid) return;
      row.addEventListener("click", () => {
        window.location.href = "/sensys/snf-user/admission-details?admission_id=" + encodeURIComponent(rid);
      });
      row.addEventListener("keydown", (e) => {
        if(e.key === "Enter" || e.key === " "){
          e.preventDefault();
          window.location.href = "/sensys/snf-user/admission-details?admission_id=" + encodeURIComponent(rid);
        }
      });
    });
  }

  async function load(){
    if(!token()){
      ALL_ROWS = SAMPLE_ROWS.slice();
      renderCounts();
      applyFilters();
      return;
    }
    try{
      const res = await fetch("/api/sensys/my-admissions?admitted_only=1", { headers: authHeaders() });
      const data = await res.json();
      if(!res.ok || !data.ok){
        ALL_ROWS = SAMPLE_ROWS.slice();
        renderCounts();
        applyFilters();
        return;
      }
      ALL_ROWS = (data.admissions || []).map(r => ({
        id: r.id,
        patient_name: r.patient_name,
        patient_dob: r.patient_dob,
        room: r.room,
        insurance_name1: r.insurance_name1,
        insurance_number1: r.insurance_number1,
        admit_date: r.admit_date,
        dc_date: r.dc_date
      }));
      renderCounts();
      applyFilters();
    }catch(e){
      ALL_ROWS = SAMPLE_ROWS.slice();
      renderCounts();
      applyFilters();
    }
  }

  tabAll.addEventListener("click", () => {
    ACTIVE_TAB = "all";
    tabAll.classList.add("on");
    tabDischarging.classList.remove("on");
    applyFilters();
  });
  tabDischarging.addEventListener("click", () => {
    ACTIVE_TAB = "discharging";
    tabDischarging.classList.add("on");
    tabAll.classList.remove("on");
    applyFilters();
  });

  search.addEventListener("input", applyFilters);

  document.getElementById("openFilters").addEventListener("click", () => {
    filterBackdrop.style.display = "flex";
  });
  document.getElementById("applyFilters").addEventListener("click", () => {
    filterBackdrop.style.display = "none";
    applyFilters();
  });
  document.getElementById("clearFilters").addEventListener("click", () => {
    admitFrom.value = "";
    admitTo.value = "";
    insuranceFilter.value = "";
    sortBy.value = "last";
    filterBackdrop.style.display = "none";
    applyFilters();
  });
  filterBackdrop.addEventListener("click", (e) => {
    if(e.target === filterBackdrop){
      filterBackdrop.style.display = "none";
    }
  });

  profileBtn.addEventListener("click", () => {
    const isOpen = profileMenu.style.display === "block";
    profileMenu.style.display = isOpen ? "none" : "block";
  });
  document.addEventListener("click", (e) => {
    if(!profileMenu.contains(e.target) && !profileBtn.contains(e.target)){
      profileMenu.style.display = "none";
    }
  });
  signOutBtn.addEventListener("click", () => {
    localStorage.removeItem("sensys_token");
    window.location.href = "/sensys/login";
  });
  changePasswordBtn.addEventListener("click", () => {
    window.location.href = "/sensys/change-password";
  });
  navHome.addEventListener("click", () => {
    window.location.href = "/sensys/snf-user";
  });
  navInpatient.addEventListener("click", () => {
    window.location.href = "/sensys/snf-user/patient-list";
  });
  navDischarged.addEventListener("click", () => {});
  navCalendar.addEventListener("click", () => {
    window.location.href = "/sensys/snf-user/calendar";
  });

  load();
})();
</script>
</body>
</html>
